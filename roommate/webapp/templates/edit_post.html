{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>roommate-edit post</title>
    <link rel="stylesheet" href="{% static 'edit_post.css' %}">
    <link rel="icon" href="{% static 'img/logo-rm.png' %}" type="image/x-ic">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Play&display=swap" rel="stylesheet"> 

</head>
<body>

    <script> //For logut button
        function confirmLogout() {
          if (confirm("Are you sure you want to logout?")) {
            // Redirect to the logout URL
            window.location.href = "roommate";
          }
        }
    </script>
    
    <div class="slide-background">
        <div class="menu_bar">
        <img src="{% static 'img/roommate-logo-white.png' %}" class="logo">
        <ul>
            <li><a href="home">Home</a></li>
            <li><a href="add_post">Add Post</a></li>
            <li><a href="my_post">My Post</a></li>

            <li><a href="#"><i class="fa fa-user" aria-hidden="true"></i> <i class="fa fa-caret-down"></i></a>
                <div class="dropdown_menu">
                    <ul>
                        <li><a href="profile">Profile</a></li>
                        <li><a href="favorites">Favorites</a></li>
                        <li><a href="#"onclick="confirmLogout()">Logout</a></li>
                    </ul>
                </div>
            </li>
        </ul>
</div>


<div class="form-container">
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="hidden" name="post_id" value="{{ post.post_id }}">
      <h2 class="form-title">Edit Post üìù</h2>

      <div class="form-grid">
          <!-- Column 1 -->
          <div class="form-column">
              <!-- Tenant Type -->
              <label for="tenantType">Tenant Type</label>
              <select id="tenantType" name="tenantType" required>
                  <option>{{post.tenant_type}}</option>
                  <option>Male</option>
                  <option>Female</option>
                  <option>Family</option>
                  <option>None</option>
              </select>

              <!-- Location -->
              <label for="location">Location</label>
              <select id="location" name="location" required>
                  <option >{{post.location}}</option>
                  <option>Airport</option>
                  <option>Banasree</option>
                  <option>Banani</option>
                  <option>Banani DOHS</option>
                  <option>Baridhara</option>
                  <option>Bashundhara Residential Area</option>
                  <option>Badda</option>
                  <option>Cantonment Area</option>
                  <option>Green Road</option>
                  <option >Gulshan</option>
                  <option >Mirpur </option>
                  <option >Mirpur DOHS</option>
                  <option >Nikunjo</option>
                  <option >Purbachal</option>
                  <option >Shyamoli</option>
                  <option >Uttara</option>
                  <option >Uttara Diabari</option>
              </select>

              <!-- Resident -->
              <label for="resident">Resident Name</label>
              <select id="resident" name="resident" required>
                  <option >{{post.resident_type}}</option>
                  <option>Apartment</option>
                  <option>Flat</option>
                  <option>Male Hostel</option>
                  <option>Female Hostel</option>
                  <option>Colony</option>
              </select>

              <!-- Description -->
              <label for="description">Description</label>
              <textarea id="description" name="description" rows="4"  required>{{post.description}}</textarea>

              <!-- Utilities -->
              <label>Utilities (Included):</label>
              <div class="checkbox-group">
                  <input type="checkbox" id="utility-elevator" name="utilities" value="Elevator" {% if "Elevator" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-elevator">Elevator</label>
                  
                  <input type="checkbox" id="utility-parking" name="utilities" value="Parking" {% if "Parking" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-parking">Parking</label>
                  
                  <input type="checkbox" id="utility-wifi" name="utilities" value="WIFI"{% if "WIFI" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-wifi">WIFI</label>
                  
                  <input type="checkbox" id="utility-pet-ok" name="utilities" value="Pet OK" {% if "Pet OK" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-pet-ok">Pet OK</label>
                  
                  <input type="checkbox" id="utility-cable-tv" name="utilities" value="Cable TV" {% if "Cable TV" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-cable-tv">Cable TV</label>
                  
                  <input type="checkbox" id="utility-ac" name="utilities" value="AC" {% if "AC" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-ac">AC</label>
                  
                  <input type="checkbox" id="utility-oven" name="utilities" value="Oven" {% if "Oven" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-oven">Oven</label>
                  
                  <input type="checkbox" id="utility-generator" name="utilities" value="Generator" {% if "Generator" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-generator">Generator</label>
                  
                  <input type="checkbox" id="utility-fridge" name="utilities" value="Fridge" {% if "Fridge" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-fridge">Fridge</label>
                  
                  <input type="checkbox" id="utility-kitchen" name="utilities" value="Kitchen" {% if "Kitchen" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-kitchen">Kitchen</label>
                  
                  <input type="checkbox" id="utility-washing-machine" name="utilities" value="Washing Machine" {% if "Washing Machine" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-washing-machine">Washing Machine</label>

                  <input type="checkbox" id="utility-trash" name="utilities" value="Trash" {% if "Trash" in post.utilities_included %}checked{% endif %}>
                  <label for="utility-trash">Trash Management</label>
              </div>

              <!-- Non-Included Bills -->
              <label>Non-Included Bills:</label>
              <div class="checkbox-group">
                  <input type="checkbox" id="non-bill-water" name="nonIncludedBills" value="Water" {% if "Water" in post.non_included_bills %}checked{% endif %}>
                  <label for="non-bill-water">Water</label>
                  
                  <input type="checkbox" id="non-bill-electricity" name="nonIncludedBills" value="Electricity" {% if "Electricity" in post.non_included_bills %}checked{% endif %}>
                  <label for="non-bill-electricity">Electricity</label>
                  
                  <input type="checkbox" id="non-bill-gas" name="nonIncludedBills" value="Gas" {% if "Gas" in post.non_included_bills %}checked{% endif %}>
                  <label for="non-bill-gas">Gas</label>
                  
                  <input type="checkbox" id="non-bill-wifi" name="nonIncludedBills" value="WIFI" {% if "WIFI" in post.non_included_bills %}checked{% endif %}>
                  <label for="non-bill-wifi">WIFI</label>
                  
                  <input type="checkbox" id="non-bill-maid" name="nonIncludedBills" value="Maid" {% if "Maid" in post.non_included_bills %}checked{% endif %}>
                  <label for="non-bill-maid">Maid</label>
                  
                  <input type="checkbox" id="non-bill-security" name="nonIncludedBills" value="Security Guard" {% if "Security Guard" in post.non_included_bills %}checked{% endif %}>
                  <label for="non-bill-security">Security Guard</label>
              </div>
          </div>

          <!-- Column 2 -->
          <div class="form-column">
              <!-- Address -->
              <label for="address">Address</label>
              <input type="text" id="address" name="address" value="{{post.address}}" placeholder="{{post.address}}" required>

              <!-- Rent -->
              <label for="rent">Rent per month (BDT)</label>
              <input type="number" id="rent" name="rent" value="{{post.rent}}" placeholder="{{post.rent}}" required>

              <!-- Area -->
              <label for="area">Area (Square feet)</label>
              <input type="number" id="area" name="area" value="{{post.area}}" placeholder="{{post.area}}">

              <!-- Furnished Options -->
              <label for="furnished">Furnished</label>
              <select id="furnished" name="furnished" required>
                  <option >{{post.furnished}}</option>
                  <option >Full Furnished</option>
                  <option >Not Furnished</option>
                  <option >Partially</option>
              </select>
               <!-- Security Deposit -->
              <label for="securityDeposit">Security Deposit</label>
              <select id="securityDeposit" name="securityDeposit" required>
                  <option >{{post.security_deposit}}</option>
                  <option value="No Deposit">No Deposit</option>
                  <option value="Half Month Rent">Half Month Rent</option>
                  <option value="1 Month Rent">1 Month Rent</option>
                  <option value="2 Months Rent">2 Months Rent</option>
              </select>

              <!-- Lease Term -->
              <label for="leaseTerm">Lease Term</label>
              <select id="leaseTerm" name="leaseTerm" required>
                  <option >{{post.lease_term}}</option>
                  <option value="No Lease">No Lease</option>
                  <option value="4 Months">4 Months</option>
                  <option value="6 Months">6 Months</option>
                  <option value="1 Year">1 Year</option>
                  <option value="2 Years">2 Years</option>
                  <option value="Other">Other</option>
              </select>

              

              <!-- Image Upload -->
              <label for="images">Upload Images (up to 4)</label>
              <div class="upload-container" onclick="document.getElementById('images').click()">
                <p>üì∏ Click to select or drag & drop your images here</p>
                <input type="file" id="images" name="images" accept="image/*" multiple>
                <div class="file-list" id="fileList">
                    <!-- Show existing images as preview -->
                    {% if post.image1 %}
                        <div class="file-item">
                            <img src="{{ post.image1.url }}" alt="Image 1 Preview" class="preview-image">
                            <button type="button" class="remove-btn" onclick="removeImage('image1')">‚úñ</button>
                        </div>
                    {% endif %}
                    {% if post.image2 %}
                        <div class="file-item">
                            <img src="{{ post.image2.url }}" alt="Image 2 Preview" class="preview-image">
                            <button type="button" class="remove-btn" onclick="removeImage('image2')">‚úñ</button>
                        </div>
                    {% endif %}
                    {% if post.image3 %}
                        <div class="file-item">
                            <img src="{{ post.image3.url }}" alt="Image 3 Preview" class="preview-image">
                            <button type="button" class="remove-btn" onclick="removeImage('image3')">‚úñ</button>
                        </div>
                    {% endif %}
                    {% if post.image4 %}
                        <div class="file-item">
                            <img src="{{ post.image4.url }}" alt="Image 4 Preview" class="preview-image">
                            <button type="button" class="remove-btn" onclick="removeImage('image4')">‚úñ</button>
                        </div>
                    {% endif %}
                </div>
            </div>
              <small>Note: You can upload up to 4 images.</small>
          </div>
      </div>

      <div class="form-row">
          <!-- Submit Button -->
          <button type="submit">Update</button>
      </div>
  </form>
</div>

<script>
const imageInput = document.getElementById("images");
const fileList = document.getElementById("fileList");

imageInput.addEventListener("change", function () {
    const files = this.files;
    const maxFiles = 4;
    fileList.innerHTML = ""; // Clear previous file list

    if (files.length > maxFiles) {
        alert(`You can upload a maximum of ${maxFiles} images.`);
        imageInput.value = ""; // Reset the input field
        return;
    }

    for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const reader = new FileReader();

        reader.onload = function (e) {
            const imgElement = document.createElement("img");
            imgElement.src = e.target.result;

            const removeBtn = document.createElement("button");
            removeBtn.textContent = "‚úñ";
            removeBtn.classList.add("remove-btn");

            removeBtn.onclick = function () {
                fileList.removeChild(fileItem);
            };

            const fileItem = document.createElement("div");
            fileItem.appendChild(imgElement);
            fileItem.appendChild(removeBtn);

            fileList.appendChild(fileItem);
        };

        reader.readAsDataURL(file);
    }
});

// Drag-and-drop functionality
const uploadContainer = document.querySelector(".upload-container");

uploadContainer.addEventListener("dragover", function (e) {
    e.preventDefault();
    uploadContainer.style.borderColor = "#007BFF";
});

uploadContainer.addEventListener("dragleave", function () {
    uploadContainer.style.borderColor = "#ccc";
});

uploadContainer.addEventListener("drop", function (e) {
    e.preventDefault();
    const files = e.dataTransfer.files;
    imageInput.files = files;
    imageInput.dispatchEvent(new Event("change"));
});

// Image removal function (to remove from preview, not from server)
function removeImage(imageField) {
  // If the user has uploaded a new image, they can remove the preview from the list
  // If you want to remove it from the server as well, this can be done when submitting the form
  // Add logic for removing images from the form data on submit (if needed)
  const imageElement = document.querySelector(`#fileList .file-item[data-field='${imageField}']`);
  if (imageElement) {
      fileList.removeChild(imageElement);
  }
}
</script> 


  <!-- Site footer -->
    <footer class="site-footer">
        <div >
          <div class="footer-row">
            <div class="col-sm-12 col-md-6">
              <h6>About Roommate.com</h6>
              <p class="text-justify">Roommate is a user-friendly web app, created by an undergraduate student,
                designed to revolutionize the way students and young professionals find accommodations.
                 The app was born out of the motivation to address a common challenge faced by many in Dhaka‚Äîfinding a
                 suitable place to live. For students in particular, navigating the rental market in a busy city like Dhaka
                 can be overwhelming, with limited resources and a lack of reliable platforms catering to their specific needs.</p>
                 <p>Roommate bridges this gap by providing a seamless platform where users can explore tailored listings, connect 
                 with potential roommates, and even sublet their spaces effortlessly. Built with simplicity and efficiency in mind,
                 Roommate offers intuitive features such as detailed profiles, advanced search options, and a focus on fostering 
                 community trust. Whether you're a student looking to share a flat or someone seeking temporary housing, Roommate makes 
                 the process faster, easier, and stress-free. By addressing the unique challenges of the rental market in Dhaka, Roommate 
                 empowers its users to find not just a living space, but a home.</p>
            </div>
  
            <div class="col-xs-6 col-md-3">
              <h6>Popular Areas</h6>
              <ul class="footer-links">
                <li><a href="">Uttara</a></li>
                <li><a href="">Mirpur</a></li>
                <li><a href="">Badda</a></li>
                <li><a href="">Dhanmondi</a></li>
                <li><a href="">Farmgate</a></li>
                <li><a href="">Airport</a></li>
                <li><a href="">Rampura</a></li>
                <li><a href="">Banani</a></li>
              </ul>
            </div>
  
            <div class="col-xs-6 col-md-3">
              <h6>Quick Links</h6>
              <ul class="footer-links">
                <li><a href="about_us">About Us</a></li>
                <li><a href="contact_us">Email Us</a></li>
                <li><a href="contribute">Contribute</a></li>
                <li><a href="policy">Policy</a></li>
                <li><a href="https://maps.app.goo.gl/2XRvxmJK95MWdnw68">Sitemap</a></li>
              </ul>
            </div>
          </div>
          <hr>
        </div>
        <div>
          <div class="foot">
            <div class="col-md-4 col-sm-6 col-xs-12">
              <ul class="social-icons">
                <li><a class="facebook" href="#"><i class="fa fa-facebook"></i></a></li>
                <li><a class="twitter" href="#"><i class="fa fa-twitter"></i></a></li>
                <li><a class="instagram" href="#"><i class="fa fa-instagram"></i></a></li>
                <li><a class="whatsapp" href="#"><i class="fa fa-whatsapp"></i></a></li>
                <li><a class="linkedin" href="#"><i class="fa fa-linkedin"></i></a></li>   
                <li><a class="github" href="#"><i class="fa fa-github"></i></a></li>
              </ul>
            </div>
            <div class="col-md-8 col-sm-6 col-xs-12">
                <p class="copyright-text">Copyright &copy; 2024 All Rights Reserved by a student of BUBT | Designed by <a href="https://www.facebook.com/ashvynie.era/">Abrin Azad Era</a>.</p>
            </div>
          </div>
        </div>
  </footer>
</body>
</html>